asyncapi: 3.0.0
info:
  title: AAS ASYNC API with CloudEvents
  version: 0.3-SNAPSHOT
  description: >-
    The specification defines how ElementCreated and ElementUpdated events of an
    Asset Administration Shell (AAS) are transmitted to the message broker (RabbitMQ with MQTT protocol support).
channels:
  aas/update/elementupdated:
    address: noauth or all or participantid
    messages:
      publish.message:
        $ref: '#/components/messages/elementUpdated'
    parameters:
      aasid:
        $ref: '#/components/parameters/aasid'
      submodelid:
        $ref: '#/components/parameters/submodelid'
      smec-idshort.property-idshort:
        $ref: '#/components/parameters/smec-idshort.property-idshort'
  aas/update/elementcreated:
    address: noauth or all or participantid
    messages:
      publish.message:
        $ref: '#/components/messages/elementCreated'
operations:
  aas/update/elementupdated.publish:
    action: send
    channel:
      $ref: '#/channels/aas~1update~1elementupdated'
    messages:
      - $ref: '#/channels/aas~1update~1elementupdated/messages/publish.message'
  aas/update/elementcreated.publish:
    action: send
    channel:
      $ref: '#/channels/aas~1update~1elementcreated'
    messages:
      - $ref: '#/channels/aas~1update~1elementcreated/messages/publish.message'
components:
  messages:
    elementUpdated:
      name: AASvalueChanged
      title: AAS Element Update message
      summary: Emitted when an AAS element is updated
      payload:
        $ref: '#/components/schemas/elementUpdatedEvent'
    elementCreated:
      name: AASelementCreated
      title: AAS Element Create message
      summary: Emitted when an AAS element is created
      payload:
        $ref: '#/components/schemas/elementCreatedEvent'
  parameters:
    aasid:
      description: The Id of the asset administration shell.
    submodelid:
      description: The Id of the submodel in the Asset Administration Shell with aasId.
    smec-idshort.property-idshort:
      description: The Id of a property in a Submodel Element Collection.
  schemas:
    elementUpdatedEvent:
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - 358c02f2-3a11-4836-971b-43a05550bf97
        source:
          description: The URL the emitting element can be obtained from. The element must be of the type indicated in the `dataschema` property.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - 'https://providercorp.com/shells/abcd'
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          enum:
            - io.admin-shell.events.v1.created
            - io.admin-shell.events.v1.updated
            - io.admin-shell.events.v1.deleted
          examples:
            - io.admin-shell.events.v1.deleted
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          examples:
            - >-
              https://raw.githubusercontent.com/admin-shell-io/aas-specs-metamodel/refs/heads/master/schemas/json/aas.json#/definitions/AssetAdministrationShell
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2024-11-26T10:46:33.2171298+01:00'
        data:
          $ref: https://raw.githubusercontent.com/admin-shell-io/aas-specs-metamodel/refs/heads/master/schemas/json/aas.json#/definitions/AssetAdministrationShell
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data
    elementCreatedEvent:
      type: object
      properties:
        specversion:
          description: The version of the CloudEvents specification which the event uses.
          type: string
          const: '1.0'
        id:
          description: Identifies the event.
          type: string
          examples:
            - ecbd132e-d834-4528-bb30-6790104ca474
        source:
          description: The URL the emitting element can be obtained from. The element must be of the type indicated in the `dataschema` property.
          type: string
          pattern: ^https?:\/\/[^\s/$.?#].[^\s]*$
          examples:
            - >-
              https://mycorp.com/aas-repo/shells/bXktYWFzCg==
        type:
          description: >-
            Describes the type of the event related to the source the event
            originated in.
          type: string
          enum:
            - io.admin-shell.events.v1.created
            - io.admin-shell.events.v1.updated
            - io.admin-shell.events.v1.deleted
          examples:
            - io.admin-shell.events.v1.created
        datacontenttype:
          description: Content type of the event data.
          type: string
          const: application/json
        dataschema:
          description: Identifies the schema that the event data adheres to.
          type: string
          format: uri
          examples:
            - >-
              https://api.swaggerhub.com/domains/Plattform_i40/Part1-MetaModel-Schemas/V3.1.0#/components/schemas/AssetAdministrationShell
        time:
          description: Timestamp of when the occurrence happened.
          format: date-time
          type: string
          examples:
            - '2024-11-26T10:44:11.9367113+01:00'
        data:
          $ref: https://raw.githubusercontent.com/admin-shell-io/aas-specs-metamodel/refs/heads/master/schemas/json/aas.json#/definitions/AssetAdministrationShell
      required:
        - specversion
        - id
        - source
        - type
        - datacontenttype
        - dataschema
        - time
      optional:
        - data